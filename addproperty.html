<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Prelaunch</title>
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <link href="assets/css/style.css" rel="stylesheet" />
  </head>

  <body>
    <header id="header">
      <div
        class="container d-flex align-items-center justify-content-lg-between"
      >
        <!-- <h1 class="logo me-auto me-lg-0"><a href="index.html">Gp<span>.</span></a></h1> -->
        <!-- Uncomment below if you prefer to use an image logo -->
        <a href="index.html" class="logo me-auto me-lg-0"
          ><img
            src="assets/img/prelaunchprops_logo_Design_Updated_Colors-(3).png"
            alt=""
            class="img-fluid"
        /></a>

        <nav id="navbar" class="navbar order-last order-lg-0">
          <ul>
            <li>
              <a class="nav-link scrollto active" href="index.html">Home</a>
            </li>
          </ul>
          <i class="bi bi-list mobile-nav-toggle"></i>
        </nav>
        <!-- .navbar -->

        <!-- <a href="#about" class="get-started-btn scrollto">Get Started</a> -->
      </div>
    </header>

    <div class="container mt-5">
      <!-- Add margin-top here -->
      <h2 class="mb-4">Add Property</h2>
      <form action="" method="POST" id="propertyForm">
        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="builderName">Builder Name:</label>
            <input
              type="text"
              class="form-control"
              id="builderName"
              name="builderName"
              placeholder="Name"
              required
            />
          </div>

          <div class="form-group col-md-6">
            <label for="bhk">BHK:</label>
            <input
              type="number"
              class="form-control"
              id="bhk"
              name="bhk"
              placeholder="3"
              required
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="projectName">Project Name:</label>
            <input
              type="text"
              class="form-control"
              id="projectName"
              name="projectName"
              placeholder="name"
              required
            />
          </div>

          <div class="form-group col-md-6">
            <label for="propertybudget">Property Budget:</label>
            <div class="input-group">
              <input
                type="number"
                class="form-control"
                id="propertybudget"
                placeholder="budget"
                step="0.01"
                value="1.42"
                required
              />
              <div class="input-group-append">
                <span class="input-group-text">CR</span>
              </div>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="propertylocation">Property Location:</label>
          <input
            type="text"
            class="form-control"
            id="propertylocation"
            name="propertylocation"
            placeholder="location"
            required
          />
        </div>

        <div class="form-group">
          <label for="propertydescription">Property Description:</label>
          <textarea
            class="form-control"
            id="propertydescription"
            placeholder="description"
            rows="4"
            required
          ></textarea>
        </div>

        <div class="form-group">
          <label for="image">Image:</label>
          <input
            type="file"
            id="image"
            name="image"
            accept="image/*"
            required
          />
        </div>

        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="propertyArea">Property Area:</label>
            <div class="input-group">
              <input
                type="number"
                class="form-control"
                id="propertyArea"
                name="propertyArea"
                placeholder="1000"
                required
              />
              <div class="input-group-append">
                <span class="input-group-text">sqft</span>
              </div>
            </div>
          </div>

          <div class="form-group col-md-6">
            <label for="floorplan">Floor Plan:</label>
            <input
              type="text"
              class="form-control"
              id="floorplan"
              name="floorplan"
              placeholder="Will be attached"
              required
            />
          </div>
        </div>

        <div class="form-group">
          <label for="amenities">Amenities:</label>
          <textarea
            class="form-control"
            id="amenities"
            name="amenities"
            rows="4"
            required
            placeholder="mention anemities"
          ></textarea>
        </div>

        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="numberofTowers">Number of Towers:</label>
            <input
              type="number"
              class="form-control"
              id="numberofTowers"
              name="numberofTowers"
              placeholder="5"
              required
            />
          </div>

          <div class="form-group col-md-6">
            <label for="numberoffloors">Number of Floors:</label>
            <input
              type="number"
              class="form-control"
              id="numberoffloors"
              name="numberoffloors"
              placeholder="30"
              required
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="possession">Possession Date:</label>
            <input
              type="datetime-local"
              class="form-control"
              id="possession"
              name="possession"
              placeholder="2028-12-01T00:00:00.000+00:00"
              required
            />
          </div>

          <div class="form-group col-md-6">
            <label for="landParcel">Land Parcel:</label>
            <div class="input-group">
              <input
                type="number"
                class="form-control"
                id="landParcel"
                name="landParcel"
                step="0.01"
                placeholder="5.5"
                required
              />
              <div class="input-group-append">
                <span class="input-group-text">acres</span>
              </div>
            </div>
          </div>
        </div>

        <button type="submit" class="btn btn-primary">Submit</button>
      </form>
    </div>

    <script>
      document
        .getElementById("propertyForm")
        .addEventListener("submit", function (event) {
          event.preventDefault();

          var selectedDate = new Date(
            document.getElementById("possession").value
          );
          var formattedDate = selectedDate.toISOString().split("T")[0];
          var formData = new FormData();
          formData.append(
            "builderName",
            document.getElementById("builderName").value
          );
          formData.append("bhk", document.getElementById("bhk").value);
          formData.append(
            "projectName",
            document.getElementById("projectName").value
          );
          formData.append(
            "propertybudget",
            document.getElementById("propertybudget").value
          );
          // document.getElementById("propertybudget_unit").value
          formData.append("propertybudget_unit", "CR");
          formData.append(
            "propertylocation",
            document.getElementById("propertylocation").value
          );
          formData.append(
            "propertydescription",
            document.getElementById("propertydescription").value
          );
          // formData.append("image", document.getElementById("image").value);
          var imageInput = document.getElementById("image");
          var imageFile = imageInput.files[0];

          formData.append("image", imageFile);
          formData.append(
            "propertyArea",
            document.getElementById("propertyArea").value
          );
          // document.getElementById("propertyArea_unit").value

          formData.append("propertyArea_unit", "sqft");
          formData.append(
            "floorplan",
            document.getElementById("floorplan").value
          );
          formData.append(
            "amenities",
            document.getElementById("amenities").value
          );
          formData.append(
            "numberofTowers",
            document.getElementById("numberofTowers").value
          );
          formData.append(
            "numberoffloors",
            document.getElementById("numberoffloors").value
          );

          formData.append("possession", formattedDate);

          formData.append(
            "landParcel",
            document.getElementById("landParcel").value
          );
          // document.getElementById("landParcelUnit").value
          formData.append("landParcelUnit", "acres");
          fetch("http://localhost:5000/properties/createproperties", {
            method: "POST",
            body: formData,
          })
            .then((response) => {
              if (response.status === 201) {
                window.location.href = "dashtable.html"; // Redirect to dashtable.html upon successful submission
              }
              return response.json(); // Return the response body as JSON
            })
            .then((data) => {
              console.log("Data:", data); // Log the response data
            })
            .catch((error) => {
              console.error("Error:", error);
            });
        });
    </script>
  </body>
</html>
